---
title: "US UFO Sightings"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(readr)
library(shiny)
library(jsonlite)
library(maptools)
library(ggplot2)
library(tidyr)
library(dplyr)
library(purrr)
library(leaflet)
library(plotly)
library(DT)
ufo_sightings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-25/ufo_sightings.csv")

```
```{r clean, include = FALSE}

#filter to US only
ufo_sightings_us <- ufo_sightings %>% 
  filter(country == 'us')

```

Column {data-width=650}
-----------------------------------------------------------------------

### All sightings

```{r}
leaflet() %>% 
  addTiles() %>% 
  fitBounds(-127.44,24.05,-65.30,50.35) %>% 
  addCircleMarkers(ufo_sightings_us$longitude, 
                   ufo_sightings_us$latitude, 
                   color = ufo_sightings_us$encounter_length, 
                   radius = 2, 
                   fill = T,
                   fillOpacity = 0.2,
                   opacity = 0.6,
                   popup = paste(ufo_sightings_us$city_area,
                                 ufo_sightings_us$date_time, 
                                 sep = "")) 

```

Column {data-width=350}
-----------------------------------------------------------------------

### Sightings by State

```{r}
ufo_sightings_us %>% 
  group_by(state) %>% 
  summarize(n_state = n()) %>% 
  ggplot() +
  geom_col(aes(x = state, y = n_state))
```

### Data

```{r}
datatable(ufo_sightings_us, extensions = "Scroller", style="bootstrap", class="compact", width="100%", options=list(deferRender=TRUE, scrollY=300, scroller=TRUE))
```

